<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Final - Bot√µes Admin</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 900px;
            margin: 20px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        
        .test-container {
            background: white;
            margin: 10px 0;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #007bff;
        }
        
        .success { border-left-color: #28a745; background: #e6ffe6; }
        .error { border-left-color: #dc3545; background: #ffe6e6; }
        .warning { border-left-color: #ffc107; background: #fff3cd; }
        
        .btn {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .btn-primary { background: #007bff; color: white; }
        .btn-success { background: #28a745; color: white; }
        .btn-danger { background: #dc3545; color: white; }
        
        .btn:hover { opacity: 0.8; }
        
        iframe {
            width: 100%;
            height: 500px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        pre {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
            font-size: 12px;
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .status-ok { background: #28a745; }
        .status-error { background: #dc3545; }
        .status-warning { background: #ffc107; }
    </style>
</head>
<body>
    <h1>üîß Teste Final - Bot√µes Admin Corrigidos</h1>
    
    <div class="test-container">
        <h3>üìã Status da Corre√ß√£o</h3>
        <div id="status">
            <p><span class="status-indicator status-ok"></span>Arquivo admin.js foi corrigido</p>
            <p><span class="status-indicator status-ok"></span>Event listeners com verifica√ß√£o de elementos</p>
            <p><span class="status-indicator status-ok"></span>Logs detalhados para debugging</p>
            <p><span class="status-indicator status-ok"></span>Fallbacks para erros</p>
        </div>
    </div>

    <div class="test-container">
        <h3>üéØ Principais Corre√ß√µes Aplicadas</h3>
        <ul>
            <li><strong>Verifica√ß√£o de elementos DOM:</strong> Antes de adicionar event listeners</li>
            <li><strong>Logs detalhados:</strong> Para identificar problemas espec√≠ficos</li>
            <li><strong>Verifica√ß√£o de depend√™ncias:</strong> Firebase e autentica√ß√£o</li>
            <li><strong>Tratamento de erro robusto:</strong> Alerts informativos</li>
            <li><strong>Fallbacks locais:</strong> Para quando Firebase falha</li>
        </ul>
    </div>

    <div class="test-container">
        <h3>üß™ Testes Autom√°ticos</h3>
        <button class="btn btn-primary" onclick="testarLogin()">1. Simular Login</button>
        <button class="btn btn-success" onclick="abrirAdmin()">2. Abrir Admin</button>
        <button class="btn btn-danger" onclick="verificarConsole()">3. Verificar Console</button>
        <div id="test-results"></div>
    </div>

    <div class="test-container">
        <h3>üîç Verifica√ß√£o em Tempo Real</h3>
        <iframe id="admin-frame" src="about:blank"></iframe>
        <div style="margin-top: 10px;">
            <button class="btn btn-primary" onclick="recarregarAdmin()">Recarregar Admin</button>
            <button class="btn btn-success" onclick="abrirNovaAba()">Abrir em Nova Aba</button>
        </div>
    </div>

    <div class="test-container">
        <h3>üìä Logs de Debug</h3>
        <pre id="debug-logs">Aguardando testes...</pre>
    </div>

    <script>
        let logs = '';
        
        function log(message) {
            console.log(message);
            logs += new Date().toLocaleTimeString() + ': ' + message + '\\n';
            document.getElementById('debug-logs').textContent = logs;
        }
        
        function updateResults(html) {
            document.getElementById('test-results').innerHTML = html;
        }
        
        function testarLogin() {
            log('üîê Simulando login de administrador...');
            
            try {
                // Criar sess√£o de login
                const session = {
                    email: 'admin@bingoinec.org.br',
                    loginTime: Date.now(),
                    expiryTime: Date.now() + (8 * 60 * 60 * 1000)
                };
                
                localStorage.setItem('bingoAdminSession', JSON.stringify(session));
                log('‚úÖ Login simulado com sucesso');
                
                updateResults(`
                    <div style="color: green; margin: 10px 0;">
                        ‚úÖ Login simulado com sucesso!<br>
                        Email: admin@bingoinec.org.br<br>
                        Agora voc√™ pode acessar a p√°gina admin.
                    </div>
                `);
                
            } catch (error) {
                log(`‚ùå Erro no login: ${error.message}`);
                updateResults(`
                    <div style="color: red; margin: 10px 0;">
                        ‚ùå Erro ao simular login: ${error.message}
                    </div>
                `);
            }
        }
        
        function abrirAdmin() {
            log('üöÄ Carregando p√°gina admin no iframe...');
            
            const iframe = document.getElementById('admin-frame');
            iframe.src = 'admin.html';
            
            // Aguardar carregamento
            iframe.onload = function() {
                log('‚úÖ P√°gina admin carregada no iframe');
                
                setTimeout(() => {
                    try {
                        // Tentar acessar o console do iframe (pode n√£o funcionar por CORS)
                        const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                        if (iframeDoc) {
                            log('‚úÖ Iframe acess√≠vel - p√°gina carregou');
                        }
                    } catch (e) {
                        log('‚ö†Ô∏è Iframe n√£o acess√≠vel (normal por seguran√ßa)');
                    }
                }, 2000);
            };
            
            updateResults(`
                <div style="color: blue; margin: 10px 0;">
                    üîÑ Carregando admin.html no iframe...<br>
                    Verifique se a p√°gina carrega sem erros.<br>
                    Se houver problemas, abra o DevTools (F12) para ver os logs.
                </div>
            `);
        }
        
        function verificarConsole() {
            log('üîç Instru√ß√µes para verificar console...');
            
            updateResults(`
                <div style="background: #e7f3ff; padding: 15px; border-radius: 5px; margin: 10px 0;">
                    <strong>üìã Instru√ß√µes para verificar os bot√µes:</strong><br><br>
                    
                    <strong>1. Abra o DevTools:</strong><br>
                    ‚Ä¢ Pressione F12 ou Ctrl+Shift+I<br>
                    ‚Ä¢ V√° para a aba "Console"<br><br>
                    
                    <strong>2. Recarregue admin.html:</strong><br>
                    ‚Ä¢ Clique em "Abrir em Nova Aba" acima<br>
                    ‚Ä¢ Ou acesse: <a href="admin.html" target="_blank">admin.html</a><br><br>
                    
                    <strong>3. Verifique os logs:</strong><br>
                    ‚Ä¢ Deve aparecer: "‚úÖ Admin panel totalmente carregado e configurado!"<br>
                    ‚Ä¢ Deve aparecer: "‚úÖ Event listener adicionado:" para cada bot√£o<br>
                    ‚Ä¢ N√ÉO deve aparecer: "‚ùå Bot√£o [nome] n√£o encontrado"<br><br>
                    
                    <strong>4. Teste os bot√µes:</strong><br>
                    ‚Ä¢ Clique nos bot√µes da p√°gina admin<br>
                    ‚Ä¢ Deve aparecer logs no console quando clicar<br>
                    ‚Ä¢ Bot√µes devem responder normalmente<br><br>
                    
                    <strong>5. Se ainda n√£o funcionar:</strong><br>
                    ‚Ä¢ Copie os erros do console<br>
                    ‚Ä¢ Verifique se todos os arquivos JS carregaram<br>
                    ‚Ä¢ Certifique-se de que fez login primeiro
                </div>
            `);
        }
        
        function recarregarAdmin() {
            const iframe = document.getElementById('admin-frame');
            iframe.src = iframe.src;
            log('üîÑ Recarregando admin no iframe...');
        }
        
        function abrirNovaAba() {
            window.open('admin.html', '_blank');
            log('üÜï Abrindo admin em nova aba...');
        }
        
        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', () => {
            log('üöÄ P√°gina de teste carregada');
            log('üìù Use os bot√µes acima para testar a corre√ß√£o dos bot√µes admin');
            
            updateResults(`
                <div style="color: blue; margin: 10px 0;">
                    üéØ Teste a corre√ß√£o seguindo os passos:<br>
                    1. Clique em "Simular Login"<br>
                    2. Clique em "Abrir Admin"<br>
                    3. Clique em "Verificar Console" para instru√ß√µes detalhadas
                </div>
            `);
        });
    </script>
</body>
</html>
